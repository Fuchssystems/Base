(self["webpackChunkbase"]=self["webpackChunkbase"]||[]).push([[312],{8030:(e,t,l)=>{"use strict";l.r(t),l.d(t,{default:()=>N});l(71);var a=l(3673),r=l(8880);const i=(0,a.HX)("data-v-a0f4abcc");(0,a.dD)("data-v-a0f4abcc");const o={key:0,class:"div-profile-images"},s={class:"row q-mb-md items-start",style:{"margin-top":"30px"}},n={class:"row q-gutter-md items-start"},d={key:0,class:"absolute-full flex flex-center"},c={key:1,class:"absolute-full flex flex-center"},g={key:1,class:"div-carousel"},m={class:"q-pa-md"},u={class:"q-gutter-y-md",style:{width:"100%"}};(0,a.Cn)();const f=i(((e,t,l,f,p,h)=>{const y=(0,a.up)("q-btn"),I=(0,a.up)("error-row-card"),b=(0,a.up)("q-skeleton"),S=(0,a.up)("q-spinner"),k=(0,a.up)("q-icon"),_=(0,a.up)("q-img"),v=(0,a.up)("confirm-yes-no"),F=(0,a.up)("q-carousel-slide"),w=(0,a.up)("q-carousel-control"),C=(0,a.up)("q-carousel"),P=(0,a.up)("q-tab"),x=(0,a.up)("q-tabs"),W=(0,a.up)("q-page-sticky"),D=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(D,{padding:""},{default:i((()=>["administration"===e.getUserPreference("profileImagesTab")?((0,a.wg)(),(0,a.j4)("div",o,[(0,a.Wm)("form",{onSubmit:t[8]||(t[8]=(0,r.iM)(((...t)=>e.submitForm&&e.submitForm(...t)),["prevent"]))},[(0,a.Wm)("input",{id:"inputImageFilesSelection",type:"file",multiple:"",accept:"image/*",ref:"inputImageFilesSelection",style:{display:"none"},onChange:t[1]||(t[1]=(...e)=>h.upload&&h.upload(...e))},null,544),(0,a.Wm)("div",s,[(0,a.Wm)(y,{class:"col",style:{"max-width":"156px"},color:"primary",icon:"cloud_upload",label:e.$t("profile_images_button_inputFiles"),onClick:t[2]||(t[2]=t=>{e.$refs.inputImageFilesSelection.click()})},null,8,["label"]),(0,a.Wm)(y,{class:"q-ml-md col",style:{"max-width":"120px"},color:"secondary",icon:"mdi-check-all",label:e.$t("profile_images_button_selectAll"),disable:e.getNumberOfSelectedFiles===e.getProfileImages.length,onClick:t[3]||(t[3]=t=>e.fileSetSelectedAll(!0))},null,8,["label","disable"]),(0,a.Wm)(y,{class:"q-ml-md col",style:{"max-width":"180px"},color:"secondary",icon:"mdi-minus",label:e.$t("profile_images_button_deslectAll"),disable:!e.getNumberOfSelectedFiles,onClick:t[4]||(t[4]=t=>e.fileSetSelectedAll(!1))},null,8,["label","disable"]),(0,a.Wm)(y,{class:"q-ml-md col",style:{"max-width":"160px"},color:"warning",icon:"delete_forever",label:e.$t("app_button_Delete")+(e.getNumberOfSelectedFiles?" ("+e.getNumberOfSelectedFiles+")":""),disable:!e.getNumberOfSelectedFiles,onClick:t[5]||(t[5]=e=>p.showConfirmDelete=!0)},null,8,["label","disable"])]),(0,a.Wm)(I,{errorList:e.getFileErrorlist},null,8,["errorList"]),e.getFilesAreLoading?((0,a.wg)(),(0,a.j4)(b,{key:0,height:"120px"})):(0,a.ry)("",!0),(0,a.Wm)("div",n,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.getProfileImages,((l,o)=>((0,a.wg)(),(0,a.j4)(_,{image:l,key:l.key,src:l.filecontent,"spinner-color":"white",style:{"max-height":"180px","max-width":"180px"},onClick:(0,r.iM)((e=>h.onImageClicked({key:l.key,selected:l.selected})),["stop"]),draggable:"",onDragstart:e=>h.dragStart(l.key,o,e),onDragover:t[6]||(t[6]=(0,r.iM)((()=>{}),["prevent"])),onDragenter:e=>h.dragEnter(l.key,o,e),onDragleave:e=>h.dragLeave(l.key,o,e),onDrop:e=>h.dragDrop(l.key,o,l.id,e)},{default:i((()=>[e.getFileProcessingStatusWithKey(l.key)?((0,a.wg)(),(0,a.j4)("div",d,[(0,a.Wm)(S,{color:"primary",size:"3em"})])):(0,a.ry)("",!0),e.getFileSelectedStatusWithKey(l.key)?((0,a.wg)(),(0,a.j4)("div",c,[(0,a.Wm)(k,{name:"mdi-check-bold",size:"xl"})])):(0,a.ry)("",!0)])),_:2},1032,["image","src","onClick","onDragstart","onDragenter","onDragleave","onDrop"])))),128))]),(0,a.Wm)(v,{propShow:p.showConfirmDelete,propConfirmMessage:h.m("app_confirm_Really_delete_number_of_recordnames",{recordname:"Picture",count:e.getNumberOfSelectedFiles}),propIconMessage:"mdi-account-question-outline",propOkButtonLabel:e.$t("app_button_Delete"),onConfirmed:h.deleteImages,onHide:t[7]||(t[7]=e=>p.showConfirmDelete=!1),key:p.showConfirmDelete},null,8,["propShow","propConfirmMessage","propOkButtonLabel","onConfirmed"])],32)])):(0,a.ry)("",!0),"carousel"===e.getUserPreference("profileImagesTab")?((0,a.wg)(),(0,a.j4)("div",g,[(0,a.Wm)("div",m,[(0,a.Wm)(C,{swipeable:"",animated:"",arrows:"","model-value":e.getImageCarouselSlideKey,fullscreen:p.carouselFullscreen,"onUpdate:fullscreen":t[10]||(t[10]=e=>p.carouselFullscreen=e),infinite:"","onUpdate:modelValue":e.fileSetimageCarouselSlideKey,height:"480px"},{control:i((()=>[(0,a.Wm)(w,{position:"bottom-right",offset:[18,18]},{default:i((()=>[(0,a.Wm)(y,{push:"",round:"",dense:"",color:"white","text-color":"primary",icon:p.carouselFullscreen?"fullscreen_exit":"fullscreen",onClick:t[9]||(t[9]=e=>p.carouselFullscreen=!p.carouselFullscreen)},null,8,["icon"])])),_:1})])),default:i((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(e.getProfileImages,(e=>((0,a.wg)(),(0,a.j4)(F,{image:e,key:e.key,name:e.key,"img-src":e.filecontent},null,8,["image","name","img-src"])))),128))])),_:1},8,["model-value","fullscreen","onUpdate:modelValue"])])])):(0,a.ry)("",!0),(0,a.Wm)(W,{expand:"",position:"top"},{default:i((()=>[(0,a.Wm)("div",u,[(0,a.Wm)(x,{"model-value":e.getUserPreference("profileImagesTab"),"no-caps":"","inline-label":"",align:"left",class:"bg-teal text-white shadow-2",breakpoint:0,"onUpdate:modelValue":h.onTabValueChange},{default:i((()=>[(0,a.Wm)(P,{name:"administration",icon:"far fa-file-image",label:e.$t("profile_images_tab_admister")},null,8,["label"]),(0,a.Wm)(P,{name:"carousel",icon:"far fa-image",label:e.$t("profile_images_tab_carousel"),disable:!e.getProfileImages.length},null,8,["label","disable"])])),_:1},8,["model-value","onUpdate:modelValue"])])])),_:1})])),_:1})}));var p=l(515),h=l.n(p),y=l(6079),I=l(6529),b=l(7874),S=l(7476),k=l(816),_=l(5987),v=l(3759),F=l(6630),w=l(6401);const C={name:"Images",data(){return{carouselFullscreen:!1,showConfirmDelete:!1,dragStartImageKey:"",dragStartImageIndex:-1}},methods:h()(h()(h()({upload(e){if(e.target.files.length){this.fileUploadInitialize();const t=Object.values(e.target.files);t.forEach((e=>{e.temporaryFileId=`${e.name}${Date.now()}`,e.isProfileImage=!1;const t=new FileReader;t.readAsDataURL(e),t.onload=t=>{const l=e;l.temporaryFileId=e.temporaryFileId,l.nameWithExtension=e.name,l.filecontent=t.target.result,l.isProcessing=!0,l.isProfileImage=!1,this.fileAddTemporaryFile(l),this[v.os]({file:e,filecontent:t.target.result,profileId:this.$store.state.profile.activeProfile&&this.$store.state.profile.activeProfile.id,temporaryFileId:e.temporaryFileId,isProfileImage:!1,token:this.getUserToken,onSuccessNotification:this.m("backend_notification_recordname_uploaded_sucessfully",{recordname_singular:this.m("recordname_profilePicture_singular")}),onSuccessNotificationParameter:{recordname_profilePicture_singular:""}})}})),this.$refs.inputImageFilesSelection.value=null}},onTabValueChange(e){console.log(`onTabValueChange: newTab: ${e}`),this.userPrefenceSet({key:"profileImagesTab",value:e}),this[F.wT]({fields:{user:{preferences:this.getUserPreferenceObject}},token:this.getUserToken})},onImageClicked(e){console.log("onImageClicked: objKeyCurrentSelected:"),console.log(e),this.fileSetSelected({key:e.key,selected:!e.selected})},deleteImages(){this.getSelectedFilesIds.length&&(this.fileUploadInitialize(),this[v.AI]({arrayFileIds:this.getSelectedFilesIds,token:this.getUserToken,onSuccessNotificationId:"backend_notification_count_recordnames_deleted_sucessfully",onSuccessNotificationParameter:{recordname:"picture"}}),this.fileDeleteFileArrayIds(this.getSelectedFilesIds))},dragStart(e,t,l){l.dataTransfer.dropEffect="move",this.dragStartImageKey=e,this.dragStartImageIndex=t},dragEnter(e,t,l){l.preventDefault(),e!==this.dragStartImageKey&&t!==this.dragStartImageIndex+1&&l.target.classList.add("drag-target")},dragLeave(e,t,l){e!==this.dragStartImageKey&&t!==this.dragStartImageIndex+1&&l.target.classList.remove("drag-target")},dragDrop(e,t,l,a){e!==this.dragStartImageKey&&t!==this.dragStartImageIndex+1&&(a.target.classList.remove("drag-target"),this.fileMoveArrayElements({fromKey:this.dragStartImageKey,toKey:e}),this[v.d3]({fileId:this.dragStartImageKey,newSortValue:this.dragStartImageIndex<t?t-1:t,oldSortValue:this.dragStartImageIndex,token:this.getUserToken}))}},(0,S.$R)([v.os,v.yi,F.wT,v.AI,v.d3])),(0,b.nv)(["fileUploadInitialize","fileAddTemporaryFile","userPrefenceSet","fileSetimageCarouselSlideKey","fileSetSelected","fileSetSelectedAll","fileDeleteFileArrayIds","fileMoveArrayElements"])),{},{m:w.m}),computed:h()({},(0,b.Se)(["getFileErrorlist","getUserToken","getProfileImages","getActiveProfileImageId","getFileProcessingStatusWithKey","getUserPreference","getUserPreferenceObject","getImageCarouselSlideKey","getFileSelectedStatusWithKey","getNumberOfSelectedFiles","getSelectedFilesIds","getFilesAreLoading"])),created(){(0,y.polyfill)({dragImageTranslateOverride:I.scrollBehaviourDragImageTranslateOverride}),this.fileUploadInitialize();const e=this.$store.state.profile.activeProfile&&this.$store.state.profile.activeProfile.id;e&&this[v.yi]({profileId:e,activeProfileImageId:this.getActiveProfileImageId,token:this.getUserToken})},components:{"confirm-yes-no":_.Z,"error-row-card":k.Z}};var P=l(4379),x=l(8240),W=l(4103),D=l(4027),T=l(9754),U=l(4554),q=l(1277),K=l(4593),A=l(7607),$=l(1007),Z=l(7547),j=l(3269),O=l(9214),L=l(7518),Q=l.n(L);C.render=f,C.__scopeId="data-v-a0f4abcc";const N=C;Q()(C,"components",{QPage:P.Z,QBtn:x.Z,QSkeleton:W.ZP,QImg:D.Z,QSpinner:T.Z,QIcon:U.Z,QCarousel:q.Z,QCarouselSlide:K.Z,QCarouselControl:A.Z,QPageSticky:$.Z,QTabs:Z.Z,QTab:j.Z,QLayout:O.Z})}}]);