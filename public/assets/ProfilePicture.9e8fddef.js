import{_ as b,bY as u,bZ as g,P as C,R as v,ab as S,S as w,V as n,W as _,X as m,ah as I,Y as r,Z as d,y as k,ai as A,aj as T,a0 as h,al as p,aT as y,ak as f,aX as E,aR as Q}from"./index.d82235c1.js";import{Q as D}from"./QBanner.6b5bd7a6.js";import{Q as F}from"./QImg.131e38be.js";import{Q as N}from"./QPage.785deebc.js";import{i as U}from"./browser-image-compression.4af2c5eb.js";import{E as W}from"./ErrorRowCard.77939c43.js";import{C as B}from"./ConfirmYesNo.e6b11e17.js";import"./QToolbar.e66f04ec.js";import"./QItemLabel.2616e595.js";import"./QList.1db696b4.js";import"./ClosePopup.48686298.js";const L={name:"ProfilePicture",data(){return{localFileContent:"",temporaryFileId:null,showConfirmDelete:!1}},methods:{upload(e){if(e.target.files.length){this.fileUploadInitialize();const o={maxSizeMB:.5,maxWidthOrHeight:640,useWebWorker:!1};U(e.target.files[0],o).then(c=>{const t=c;this.temporaryFileId=Date.now(),t.temporaryFileId=this.temporaryFileId,t.isProfileImage=!0;const i=new FileReader;i.readAsDataURL(t),i.onload=a=>{const l=t;l.temporaryFileId=t.temporaryFileId,l.nameWithExtension=t.name,l.filecontent=a.target.result,l.isProcessing=!0,l.isProfileImage=!1,this.fileAddTemporaryFile(l),this.localFileContent=a.target.result,this[u]({file:t,filecontent:this.localFileContent,profileId:this.$store.state.profile.activeProfile&&this.$store.state.profile.activeProfile.id,temporaryFileId:this.temporaryFileId,isProfileImage:!0,oldProfileImageId:this.getActiveProfileImageId,token:this.getUserToken,onSuccessNotification:this.m("backend_notification_recordname_uploaded_sucessfully",{recordname_singular:this.m("recordname_profilePicture_singular")}),onSuccessNotificationParameter:{recordname_profilePicture_singular:""}})}}).catch(c=>{console.log(c.message)})}},deleteImage(){this.getActiveProfileImageId&&(this.fileUploadInitialize(),this.temporaryFileId=null,this.localFileContent="",this[g]({fileId:this.getActiveProfileImageId,token:this.getUserToken,onSuccessNotification:this.m("backend_notification_recordname_deleted_sucessfully",{recordname_singular:this.m("recordname_profilePicture_singular")}),onSuccessNotificationParameter:{recordname_profilePicture_singular:""}}))},...C(["fileAddTemporaryFile","fileUploadInitialize"]),...v([u,g]),m:S},computed:{...w(["getFileErrorlist","getUserToken","getFileProcessingStatusWithTemporaryFileId","getActiveProfileImageContent","getActiveProfileImageId"])},created(){this.fileUploadInitialize()},components:{"confirm-yes-no":B,"error-row-card":W}},R={class:"row q-mb-md"},z={class:"row q-mb-md items-start"},q={key:0,class:"row q-mb-md"},M={key:0,class:"absolute-full flex flex-center"},O={key:1,class:"row q-mb-md"},V={key:0,class:"absolute-full flex flex-center"};function x(e,o,c,t,i,a){const l=I("confirm-yes-no"),P=I("error-row-card");return n(),_(N,{padding:""},{default:m(()=>[r(Q,{class:"input-card"},{default:m(()=>[d("form",{onSubmit:o[4]||(o[4]=E((...s)=>e.submitForm&&e.submitForm(...s),["prevent"]))},[d("input",{id:"inputImageFileSelection",type:"file",accept:"image/*",ref:"inputImageFileSelection",style:{display:"none"},onChange:o[0]||(o[0]=(...s)=>a.upload&&a.upload(...s))},null,544),d("div",R,[r(D,{class:"bg-grey-3 col"},{avatar:m(()=>[r(k,{name:"portrait",color:"primary"})]),default:m(()=>[A(" "+T(e.$t("profile_profilePicture_title")),1)]),_:1})]),d("div",z,[r(h,{color:"primary",icon:"cloud_upload",label:e.getActiveProfileImageContent?e.$t("profile_profilePicture_button_changeFile_label"):e.$t("profile_profilePicture_button_selectFile_label"),disable:e.getFileProcessingStatusWithTemporaryFileId(i.temporaryFileId),onClick:o[1]||(o[1]=s=>{e.$refs.inputImageFileSelection.click()})},null,8,["label","disable"]),r(h,{class:"q-ml-md",color:"secondary",icon:"delete_forever",label:e.$t("profile_profilePicture_button_deleteFile_label"),disable:!e.getActiveProfileImageId||e.getFileProcessingStatusWithTemporaryFileId(i.temporaryFileId),onClick:o[2]||(o[2]=s=>i.showConfirmDelete=!0)},null,8,["label","disable"])]),i.localFileContent?(n(),p("div",q,[r(F,{src:i.localFileContent,"spinner-color":"white",style:{"max-height":"200px","max-width":"200px"}},{default:m(()=>[e.getFileProcessingStatusWithTemporaryFileId(i.temporaryFileId)?(n(),p("div",M,[r(y,{color:"primary",size:"3em"})])):f("",!0)]),_:1},8,["src"])])):f("",!0),!i.localFileContent&&e.getActiveProfileImageContent?(n(),p("div",O,[r(F,{src:e.getActiveProfileImageContent,"spinner-color":"white",style:{"max-height":"200px","max-width":"200px"}},{default:m(()=>[e.getFileProcessingStatusWithTemporaryFileId(i.temporaryFileId)?(n(),p("div",V,[r(y,{color:"primary",size:"3em"})])):f("",!0)]),_:1},8,["src"])])):f("",!0),(n(),_(l,{propShow:i.showConfirmDelete,propConfirmMessage:a.m("app_confirm_Really_delete_recordname",{recordname_nominativSingular:e.$t("recordname_profilePicture_nominativSingular")}),propIconMessage:"mdi-account-question-outline",propOkButtonLabel:e.$t("app_button_Delete"),onConfirmed:a.deleteImage,onHide:o[3]||(o[3]=s=>i.showConfirmDelete=!1),key:i.showConfirmDelete},null,8,["propShow","propConfirmMessage","propOkButtonLabel","onConfirmed"])),r(P,{errorList:e.getFileErrorlist},null,8,["errorList"])],32)]),_:1})]),_:1})}var oe=b(L,[["render",x]]);export{oe as default};
