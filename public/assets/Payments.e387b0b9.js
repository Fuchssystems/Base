import{br as f,_ as w,ab as p,c2 as y,P as L,R as A,S as B,V as d,W as h,X as r,ah as C,Y as s,Z as n,y as b,ai as u,aj as c,aW as Q,al as g,aR as P,an as k,am as E,ak as I,c3 as T,c4 as N}from"./index.7938054f.js";import{Q as V}from"./QBanner.77ae7398.js";import{Q as x,a as D}from"./QToolbar.5e8661aa.js";import{Q as $,b as q,a as M}from"./QItemLabel.3dccd102.js";import{Q as F}from"./QList.983ed313.js";import{Q as S}from"./QPage.f1dcf01a.js";import{E as U}from"./ErrorRowCard.4ade862b.js";const j=(e,a)=>{let t=0;for(let o=0;o<e.length;o+=1)e[o]===a&&(t+=1);return t},_=function(a){let t=0;if(a&&typeof a!="number"){const o=f.t("app_locale_thousandsSeperator"),m=f.t("app_locale_decimalPoint");j(a,o)===1&&a.indexOf(m)===-1&&(a=a.replace(o,m)),t=parseFloat(a.replace(o,"").replace(m,"."))}return Number.isNaN(t)&&(t=0),t};const R={name:"Payments",components:{"error-row-card":U},data(){return{formDataPayment:{amount:this.formatAmount(this.$store.state.payment.amount)}}},mounted(){const e=document.createElement("script");e.async=!0,e.addEventListener("load",this.onPayPalLoaded),e.setAttribute("src",`https://www.paypal.com/sdk/js?client-id=Ac1YkChXM-U7aX4JCG56VbM0I2Vg3PUIjN4qmq9_dJJ7q_ahZ9Iux1TqIUwL_cxnRCW-qx0QajvCj01A&currency=EUR&locale=${p("app_locale_payPal")}`),document.head.appendChild(e)},methods:{formatAmount(e){return new Intl.NumberFormat(p("app_locale_browser"),{minimumFractionDigits:2,maximumFractionDigits:2}).format(e)},onBlurAmount(e){this.formDataPayment.amount=this.formatAmount(_(e.target.value))},paypalCallbackTransactionCompleted(e){this[y]({details:e,token:this.getUserToken}),this.formDataPayment.amount=this.formatAmount(0),this.$refs.amount.resetValidation(),this.paymentSetmessage([p("payments_paypal_message_transaction_success",{amountLocalized:e.purchase_units[0].amount.value,senderName:e.payer.name.given_name})])},onPayPalLoaded(){window.paypal.Buttons.bind(this)({onInit:(a,t)=>{t.disable(),this.$refs.amount.$el.addEventListener("keyup",()=>{this.$refs.amount.validate()?t.enable():t.disable()})},createOrder:(a,t)=>t.order.create({purchase_units:[{amount:{value:_(this.formDataPayment.amount)}}]}),onApprove:(a,t)=>t.order.capture().then(o=>this.paypalCallbackTransactionCompleted(o))}).render(this.$refs.paypalButton)},validateAmount(e){let a=!1;if(e){const t=_(e);a=t>=.01&&t<=1e6}return a},onKeyupFormData(e){(this.getPaymentMessageList.length||this.getPaymentErrorList.length)&&this.resetPaymentMessageErrorLists(),e&&e==="amount"&&this.$refs.amount.validate()},...L(["paymentSetmessage","resetPaymentMessageErrorLists"]),...A([y])},computed:{...B(["getPaymentMessageList","getPaymentErrorList","getUserToken"])}},K=e=>(T("data-v-31a21b3c"),e=e(),N(),e),W={class:"row q-mb-md"},Y={class:"row"},G=K(()=>n("div",{class:"row q-mb-md"},[n("div",{class:"col-6 text-subtitle2"},[n("div",null,[u("Paypal sandbox email: test@fuchs.computer"),n("br"),u("Password: 12345678")])])],-1)),J={class:"row q-mb-md justify-between"},O={ref:"paypalButton",class:"col-4"},X={key:0,class:"row"};function Z(e,a,t,o,m,i){const v=C("error-row-card");return d(),h(S,{padding:""},{default:r(()=>[s(P,{class:"input-card"},{default:r(()=>[n("form",null,[n("div",W,[s(V,{class:"bg-grey-3 col"},{avatar:r(()=>[s(b,{name:"euro_symbol",color:"primary"})]),default:r(()=>[u(" "+c(e.$t("payments_paypal_title")),1)]),_:1})]),n("div",Y,[s(Q,{modelValue:m.formDataPayment.amount,"onUpdate:modelValue":a[0]||(a[0]=l=>m.formDataPayment.amount=l),onKeyup:a[1]||(a[1]=l=>i.onKeyupFormData("amount")),onBlur:i.onBlurAmount,rules:[l=>i.validateAmount(l)||e.$t("app_std_err_enter_amount_between",{min:i.formatAmount(.01),max:1e5})],ref:"amount","lazy-rules":"",outlined:"",class:"col",style:{"max-width":"200px"},label:e.$t("payments_paypal_field_amount_label"),"stack-label":"","input-style":"text-align: left",prefix:"\u20AC"},null,8,["modelValue","onBlur","rules","label"])]),G,n("div",J,[n("div",O,null,512)]),e.getPaymentMessageList.length?(d(),g("div",X,[s(P,{flat:"",bordered:"",class:"message-card q-mt-md bg-green-1"},{default:r(()=>[s(x,{class:"bg-green-1"},{default:r(()=>[s(b,{name:"message",size:"32px",color:"green"}),s(D,null,{default:r(()=>[u(c(e.$t("backend_message_header")),1)]),_:1})]),_:1}),s(F,{bordered:""},{default:r(()=>[(d(!0),g(k,null,E(e.getPaymentMessageList,l=>(d(),h($,{key:l,class:"q-my-xs message-item"},{default:r(()=>[s(q,null,{default:r(()=>[s(M,null,{default:r(()=>[u(c(l),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):I("",!0),s(v,{errorList:e.getPaymentErrorList},null,8,["errorList"])])]),_:1})]),_:1})}var oe=w(R,[["render",Z],["__scopeId","data-v-31a21b3c"]]);export{oe as default};
