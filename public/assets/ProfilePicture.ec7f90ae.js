import{_ as b,bY as f,bZ as u,P as C,R as v,ab as w,S,V as l,W as g,X as a,ah as _,Y as t,Z as n,y as k,ai as A,aj as T,a0 as I,al as m,aT as h,ak as c,aX as E,aR as Q}from"./index.cbecdcbb.js";import{Q as D}from"./QBanner.05f4bf5f.js";import{Q as y}from"./QImg.9f4b0dcc.js";import{Q as N}from"./QPage.e178c377.js";import{E as U}from"./ErrorRowCard.1dd5c011.js";import{C as B}from"./ConfirmYesNo.02272142.js";import"./QToolbar.9345a175.js";import"./QItemLabel.c74447ef.js";import"./QList.f6826a82.js";import"./ClosePopup.772ab22b.js";const L={name:"ProfilePicture",data(){return{localFileContent:"",temporaryFileId:null,showConfirmDelete:!1}},methods:{upload(e){if(e.target.files.length){this.fileUploadInitialize();const i=e.target.files[0];this.temporaryFileId=Date.now(),i.temporaryFileId=this.temporaryFileId,i.isProfileImage=!0;const d=new FileReader;d.readAsDataURL(i),d.onload=p=>{const r=i;r.temporaryFileId=i.temporaryFileId,r.nameWithExtension=i.name,r.filecontent=p.target.result,r.isProcessing=!0,r.isProfileImage=!1,this.fileAddTemporaryFile(r),this.localFileContent=p.target.result,this[f]({file:i,filecontent:this.localFileContent,profileId:this.$store.state.profile.activeProfile&&this.$store.state.profile.activeProfile.id,temporaryFileId:this.temporaryFileId,isProfileImage:!0,oldProfileImageId:this.getActiveProfileImageId,token:this.getUserToken,onSuccessNotification:this.m("backend_notification_recordname_uploaded_sucessfully",{recordname_singular:this.m("recordname_profilePicture_singular")}),onSuccessNotificationParameter:{recordname_profilePicture_singular:""}})}}},deleteImage(){this.getActiveProfileImageId&&(this.fileUploadInitialize(),this.temporaryFileId=null,this.localFileContent="",this[u]({fileId:this.getActiveProfileImageId,token:this.getUserToken,onSuccessNotification:this.m("backend_notification_recordname_deleted_sucessfully",{recordname_singular:this.m("recordname_profilePicture_singular")}),onSuccessNotificationParameter:{recordname_profilePicture_singular:""}}))},...C(["fileAddTemporaryFile","fileUploadInitialize"]),...v([f,u]),m:w},computed:{...S(["getFileErrorlist","getUserToken","getFileProcessingStatusWithTemporaryFileId","getActiveProfileImageContent","getActiveProfileImageId"])},created(){this.fileUploadInitialize()},components:{"confirm-yes-no":B,"error-row-card":U}},R={class:"row q-mb-md"},W={class:"row q-mb-md items-start"},q={key:0,class:"row q-mb-md"},z={key:0,class:"absolute-full flex flex-center"},V={key:1,class:"row q-mb-md"},M={key:0,class:"absolute-full flex flex-center"};function G(e,i,d,p,r,s){const F=_("confirm-yes-no"),P=_("error-row-card");return l(),g(N,{padding:""},{default:a(()=>[t(Q,{class:"input-card"},{default:a(()=>[n("form",{onSubmit:i[4]||(i[4]=E((...o)=>e.submitForm&&e.submitForm(...o),["prevent"]))},[n("input",{id:"inputImageFileSelection",type:"file",accept:"image/*",ref:"inputImageFileSelection",style:{display:"none"},onChange:i[0]||(i[0]=(...o)=>s.upload&&s.upload(...o))},null,544),n("div",R,[t(D,{class:"bg-grey-3 col"},{avatar:a(()=>[t(k,{name:"portrait",color:"primary"})]),default:a(()=>[A(" "+T(e.$t("profile_profilePicture_title")),1)]),_:1})]),n("div",W,[t(I,{color:"primary",icon:"cloud_upload",label:e.getActiveProfileImageContent?e.$t("profile_profilePicture_button_changeFile_label"):e.$t("profile_profilePicture_button_selectFile_label"),disable:e.getFileProcessingStatusWithTemporaryFileId(r.temporaryFileId),onClick:i[1]||(i[1]=o=>{e.$refs.inputImageFileSelection.click()})},null,8,["label","disable"]),t(I,{class:"q-ml-md",color:"secondary",icon:"delete_forever",label:e.$t("profile_profilePicture_button_deleteFile_label"),disable:!e.getActiveProfileImageId||e.getFileProcessingStatusWithTemporaryFileId(r.temporaryFileId),onClick:i[2]||(i[2]=o=>r.showConfirmDelete=!0)},null,8,["label","disable"])]),r.localFileContent?(l(),m("div",q,[t(y,{src:r.localFileContent,"spinner-color":"white",style:{"max-height":"200px","max-width":"200px"}},{default:a(()=>[e.getFileProcessingStatusWithTemporaryFileId(r.temporaryFileId)?(l(),m("div",z,[t(h,{color:"primary",size:"3em"})])):c("",!0)]),_:1},8,["src"])])):c("",!0),!r.localFileContent&&e.getActiveProfileImageContent?(l(),m("div",V,[t(y,{src:e.getActiveProfileImageContent,"spinner-color":"white",style:{"max-height":"200px","max-width":"200px"}},{default:a(()=>[e.getFileProcessingStatusWithTemporaryFileId(r.temporaryFileId)?(l(),m("div",M,[t(h,{color:"primary",size:"3em"})])):c("",!0)]),_:1},8,["src"])])):c("",!0),(l(),g(F,{propShow:r.showConfirmDelete,propConfirmMessage:s.m("app_confirm_Really_delete_recordname",{recordname_nominativSingular:e.$t("recordname_profilePicture_nominativSingular")}),propIconMessage:"mdi-account-question-outline",propOkButtonLabel:e.$t("app_button_Delete"),onConfirmed:s.deleteImage,onHide:i[3]||(i[3]=o=>r.showConfirmDelete=!1),key:r.showConfirmDelete},null,8,["propShow","propConfirmMessage","propOkButtonLabel","onConfirmed"])),t(P,{errorList:e.getFileErrorlist},null,8,["errorList"])],32)]),_:1})]),_:1})}var ee=b(L,[["render",G]]);export{ee as default};
